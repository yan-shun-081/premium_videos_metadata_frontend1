<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Secure Encrypted Login + Upload Portal</title>

<style>
  :root {
    --primary: #6366f1;
    --secondary: #64748b;
    --accent: #f472b6;
    --success: #22c55e;
    --error: #ef4444;
    --bg1: #0f172a;
    --bg2: #1e293b;
    --card: #f9fafb;
  }

  body {
    font-family: 'Poppins', system-ui, sans-serif;
    background: linear-gradient(135deg, var(--bg1), var(--bg2));
    color: #0f172a;
    margin: 0;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
  }

  .gradient-bg {
    position: fixed;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle at 50% 50%, #60a5fa40, #6366f140, #f472b640, transparent);
    filter: blur(90px);
    z-index: 0;
    animation: float 8s infinite ease-in-out alternate;
    pointer-events: none;
  }

  @keyframes float {
    0% { transform: translate(0, 0); opacity: 0.8; }
    50% { transform: translate(5%, -5%); opacity: 1; }
    100% { transform: translate(-5%, 5%); opacity: 0.8; }
  }

  .wrap {
    width: 95%;
    max-width: 480px;
    position: relative;
    z-index: 2;
  }

  .card {
    background: var(--card);
    border-radius: 18px;
    padding: 26px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.25);
    margin-bottom: 24px;
    position: relative;
    z-index: 2;
    animation: fadeIn 0.7s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px) scale(0.97); }
    to { opacity: 1; transform: translateY(0) scale(1); }
  }

  h2 {
    text-align: center;
    color: var(--primary);
    margin-bottom: 16px;
    font-weight: 700;
  }

  label {
    display: block;
    margin-top: 10px;
    font-weight: 600;
    color: #334155;
  }

  input, select, button {
    font-family: inherit;
  }

  input, select {
    width: 100%;
    padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid #cbd5e1;
    box-sizing: border-box;
    margin-top: 6px;
    font-size: 0.95rem;
    background: #fff;
    transition: box-shadow 0.2s, border 0.2s;
    -webkit-appearance: none;
  }

  input:focus, select:focus {
    outline: none;
    border: 1px solid var(--primary);
    box-shadow: 0 0 8px var(--primary);
  }

  .select-wrap {
    position: relative;
  }

  .select-wrap::after {
    content: "‚ñæ";
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    color: #475569;
  }

  button {
    background: linear-gradient(135deg, var(--primary), var(--accent));
    color: white;
    font-weight: 600;
    border: 0;
    border-radius: 10px;
    padding: 12px 14px;
    cursor: pointer;
    margin-top: 16px;
    width: 100%;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  button:hover {
    transform: scale(1.03);
    box-shadow: 0 0 14px rgba(99,102,241,0.5);
  }

  button.secondary {
    background: var(--secondary);
  }

  .small { font-size: 0.9rem; color: #475569; margin-top: 8px; }
  .error { color: var(--error); font-weight: 600; }
  .success { color: var(--success); font-weight: 600; }

  pre {
    background: #0f172a;
    color: #e2e8f0;
    border-radius: 10px;
    padding: 12px;
    overflow-x: auto;
  }

  .hidden { display: none; }

  .card::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 2px;
    background: linear-gradient(135deg, var(--accent), var(--primary), var(--success));
    background-size: 400% 400%;
    animation: glow 8s ease infinite;
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    z-index: 1;
    pointer-events: none;
  }

  @keyframes glow {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  @media (max-width:420px){ .card { padding: 18px; border-radius: 14px; } }
</style>
</head>
<body>
<div class="gradient-bg"></div>

<div class="wrap">
  <!-- LOGIN CARD -->
  <div class="card" id="loginCard">
    <h2>üîê Secure Login</h2>
    <label>Username</label>
    <input id="loginUser" type="text" autocomplete="username" placeholder="Enter username" />
    <label>Password</label>
    <input id="loginPass" type="password" autocomplete="current-password" placeholder="Enter password" />
    <button id="loginBtn" type="button">Login</button>
    <button id="reloadBtn" class="secondary" type="button">Reload encrypted file</button>
    <p class="small">Status: <span id="loginStatus">Waiting for encrypted data...</span></p>
    <pre id="debug" class="hidden"></pre>
  </div>

  <!-- APP CARD -->
  <div class="card hidden" id="appCard">
    <h2>üì§ Upload Archive Metadata</h2>

    <label>Type</label>
    <div class="select-wrap">
      <select id="type">
        <option value="video">Video</option>
        <option value="pdf">PDF</option>
      </select>
    </div>

    <label>Archive Content URL</label>
    <input id="archiveContentUrl" type="text" placeholder="Enter content URL" />

    <label>Thumbnail / Image URL</label>
    <input id="archiveImageUrl" type="text" placeholder="Enter image URL" />

    <label>Title</label>
    <input id="title" type="text" placeholder="Enter title" />

    <label>Username</label>
    <input id="postUsername" type="text" readonly />

    <label>Phone number (optional)</label>
    <input id="phoneNumber" type="text" placeholder="+91..." />

    <button id="postBtn" type="button">üöÄ Post Metadata</button>
    <button id="logoutBtn" class="secondary" type="button">Logout</button>

    <h3 style="margin-top:10px;">Response</h3>
    <pre id="responseArea">‚Äî</pre>
  </div>
</div>

<!-- === CONNECT BRIDGE === -->
<iframe src="bridge.html" id="bridgeFrame" style="display:none;"></iframe>

<script>
// === Communication setup ===
window.addEventListener("message", (event) => {
  const msg = event.data;
  if (!msg || typeof msg !== "object") return;

  switch (msg.type) {
    case "disablePost":
      document.getElementById("postBtn").disabled = true;
      document.getElementById("responseArea").textContent = "Posting disabled by bridge.";
      break;
    case "injectUsername":
      document.getElementById("postUsername").value = msg.value || "";
      break;
    case "triggerSend":
      document.getElementById("postBtn").click();
      break;
    case "getStatus":
      event.source.postMessage({
        type: "statusResponse",
        loggedIn: !document.getElementById("loginCard").classList.contains("hidden")
      }, "*");
      break;
  }
});

// Helper for sending message to bridge
function sendToBridge(type, data={}) {
  const frame = document.getElementById("bridgeFrame").contentWindow;
  frame.postMessage({type, ...data}, "*");
}
</script>

<!-- your existing big script below unchanged -->
<script>
  /* ... your full script code (crypto, login, upload, etc.) stays same here ... */
</script>

</body>
</html>
